<!DOCTYPE html>
<html lang="en">
<head>  
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Survey Follow-up Status | Webropol Design System</title>
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,500" rel="stylesheet">
  <link href="../ds.css" rel="stylesheet">
  <script src="https://kit.fontawesome.com/50ef2d3cf8.js" crossorigin="anonymous"></script>
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      background-color: #f6fbfd;
    }
    .table-border-collapse {
      border-collapse: collapse;
    }
    .table-border-separate {
      border-collapse: separate;
      border-spacing: 0;
    }
    .text-primary {
      color: #1976d2;
    }
    .data-indicator {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 4px;
    }
    .data-indicator .value {
      font-weight: 500;
      font-size: 14px;
    }
    .data-indicator .type {
      font-size: 11px;
      color: #666;
      opacity: 0.8;
    }
    .success-dot {
      display: inline-block;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      margin-right: 4px;
    }
    .dot-sent {
      background-color: #1976d2;
    }
    .dot-submitted {
      background-color: #4caf50;
    }    .dot-pending {
      background-color: #9e9e9e;
    }
      /* Table layout styles */
    .table-border-collapse {
      width: 100%;
      table-layout: fixed;
    }
    
    /* When only one column is visible */
    .table-border-collapse.single-column td:first-child {
      width: 100% !important;
    }
    
    /* Responsive width adjustments */
    .table-border-collapse.n-only th:nth-child(1),
    .table-border-collapse.n-only td:nth-child(1) {
      width: 60% !important;
    }
    
    .table-border-collapse.n-only th:nth-child(2),
    .table-border-collapse.n-only th:nth-child(4),
    .table-border-collapse.n-only td:nth-child(2),
    .table-border-collapse.n-only td:nth-child(4) {
      width: 20% !important;
    }
    
    .table-border-collapse.pct-only th:nth-child(1),
    .table-border-collapse.pct-only td:nth-child(1) {
      width: 60% !important;
    }
    
    .table-border-collapse.pct-only th:nth-child(3),
    .table-border-collapse.pct-only th:nth-child(5),
    .table-border-collapse.pct-only td:nth-child(3), 
    .table-border-collapse.pct-only td:nth-child(5) {
      width: 20% !important;
    }
    
    .table-border-collapse th,
    .table-border-collapse td {
      transition: width 0.3s ease;
    }
    
    /* Ensure footer rows maintain proper layout when filtering */
    .table-border-collapse tfoot tr td {
      box-sizing: border-box;
    }

    /* Additional column visibility styles */
    .n-only .col-pct, .pct-only .col-n {
      display: none !important;
    }
    
    .single-column .col-n,
    .single-column .col-pct {
      display: none !important;
    }
    
    /* For automatic width adjustment */
    .table-border-collapse.both-visible td:first-child {
      width: 40% !important;
    }
    
    .table-border-collapse.both-visible td.col-n,
    .table-border-collapse.both-visible td.col-pct {
      width: 15% !important;
    }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center">
  <div class="w-full max-w-6xl bg-white rounded-xl shadow p-6 border border-[#e3eaf3]">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-lg font-medium text-primary">Email survey link responses</h2>
      <div class="flex items-center gap-2">
        <span class="text-sm text-gray-700">Show:</span>
        <label class="inline-flex items-center text-xs mr-2">
          <input type="checkbox" checked class="accent-[#1976d2] mr-1" id="toggle-n"> n
        </label>
        <label class="inline-flex items-center text-xs">
          <input type="checkbox" checked class="accent-[#1976d2] mr-1" id="toggle-pct"> %
        </label>
        <button class="ml-4 px-2 py-1 bg-[#e6f4ea] border border-[#b7e1cd] rounded text-[#217346] flex items-center text-xs font-medium hover:bg-[#d2f0db] transition" title="Export to Excel">
          <i class="fas fa-file-excel mr-1"></i> Excel
        </button>
      </div>
    </div>
    
    <!-- Summary Table -->
    <table class="w-full text-sm table-border-separate mb-5">
      <tbody>
        <tr class="border-b border-[#bfc9d1]">
          <td class="py-2 pl-2 pr-4 text-gray-700">Individual recipients</td>
          <td class="py-2 px-2 text-right text-gray-900 font-medium w-24" id="indiv-n">6</td>
          <td class="py-2 px-2 text-right text-gray-500 w-24" id="indiv-pct">-</td>
        </tr>
        <tr class="border-b border-[#bfc9d1]">
          <td class="py-2 pl-2 pr-4 text-gray-700">Total amount of emails with email survey link sent (reminders included)</td>
          <td class="py-2 px-2 text-right text-gray-900 font-medium" id="total-n">10</td>
          <td class="py-2 px-2 text-right text-gray-500" id="total-pct">-</td>
        </tr>
        <tr>
          <td class="py-2 pl-2 pr-4 text-gray-700">Email survey link responses</td>
          <td class="py-2 px-2 text-right text-gray-900 font-medium" id="resp-n">0</td>
          <td class="py-2 px-2 text-right text-gray-500" id="resp-pct">0 %</td>
        </tr>
      </tbody>
    </table>
    
    <!-- Main Data Table -->
    <div class="border-t border-[#bfc9d1] pt-4">
      <div class="overflow-auto">
        <table class="w-full text-sm table-border-collapse">          <thead>
            <tr class="border-b border-[#bfc9d1]">
              <th class="py-3 px-4 text-left font-medium text-gray-700">Survey</th>
              <th class="py-3 px-3 text-center font-medium text-gray-700" id="col-n1">
                <div class="flex items-center justify-center gap-2">
                  <span class="success-dot dot-sent"></span>
                  <span>Email links sent (n)</span>
                </div>
              </th>
              <th class="py-3 px-3 text-center font-medium text-gray-700" id="col-pct1">
                <div class="flex items-center justify-center gap-2">
                  <span class="success-dot dot-sent"></span>
                  <span>Email links sent (%)</span>
                </div>
              </th>
              <th class="py-3 px-3 text-center font-medium text-gray-700" id="col-n2">
                <div class="flex items-center justify-center gap-2">
                  <span class="success-dot dot-submitted"></span>
                  <span>Survey submitted (n)</span>
                </div>
              </th>
              <th class="py-3 px-3 text-center font-medium text-gray-700" id="col-pct2">
                <div class="flex items-center justify-center gap-2">
                  <span class="success-dot dot-submitted"></span>
                  <span>Survey submitted (%)</span>
                </div>
              </th>
            </tr>
          </thead>
          <tbody id="mainTableBody">
            <!-- Rows injected by JS -->
          </tbody>
          <tfoot>
            <tr>
              <td colspan="5" class="px-0 py-0">
                <div class="flex justify-end items-center py-2 px-4 text-xs text-gray-600 gap-2">
                  <button class="flex items-center text-gray-400 hover:text-primary transition-colors">
                    <i class="fas fa-chevron-left mr-1"></i> Previous
                  </button>
                  <span class="font-medium">1 / 1</span>
                  <button class="flex items-center text-gray-400 hover:text-primary transition-colors">
                    Next <i class="fas fa-chevron-right ml-1"></i>
                  </button>
                </div>
              </td>
            </tr>            <tr class="border-t border-[#bfc9d1]" id="totalRow">
              <td class="py-3 px-4 text-left font-medium text-gray-700">Total emails sent</td>
              <td class="py-3 px-4 text-center font-medium text-gray-900 col-n">10</td>
              <td class="py-3 px-4 text-center font-medium text-gray-900 col-pct">100</td>
              <td class="py-3 px-4 text-center font-medium text-gray-900 col-n">0</td>
              <td class="py-3 px-4 text-center font-medium text-gray-900 col-pct">0</td>
            </tr>
            <tr class="border-t border-b border-[#bfc9d1]" id="publicRow">
              <td class="py-3 px-4 text-left font-medium text-gray-700">Public weblink</td>
              <td class="py-3 px-4 text-center font-medium text-gray-900 col-n">-</td>
              <td class="py-3 px-4 text-center font-medium text-gray-900 col-pct">-</td>
              <td class="py-3 px-4 text-center font-medium text-gray-900 col-n">1</td>
              <td class="py-3 px-4 text-center font-medium text-gray-900 col-pct">-</td>
            </tr>            <tr id="totalSubmittedRow">
              <td class="py-3 px-4 text-right font-medium text-gray-700" colspan="3">Total submitted surveys:</td>
              <td class="py-3 px-4 text-center font-medium text-gray-900 col-n" colspan="1">1</td>
              <td class="py-3 px-4 text-center font-medium text-gray-900 col-pct" colspan="1"></td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
  </div>
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // Table data
    const mainTableData = [
      { label: 'Email survey link sending 05.12.2024, 08:38', sentN: 5, sentPct: 100, subN: 0, subPct: 0 },
      { label: 'Email survey link sending 05.12.2024, 07:51', sentN: 1, sentPct: 100, subN: 0, subPct: 0 },
      { label: 'Email survey link sending 05.12.2024, 07:40', sentN: 1, sentPct: 100, subN: 0, subPct: 0 },
      { label: 'Email survey link sending 05.12.2024, 07:37', sentN: 1, sentPct: 100, subN: 0, subPct: 0 },
      { label: 'Email survey link sending 05.12.2024, 07:33', sentN: 1, sentPct: 100, subN: 0, subPct: 0 },
      { label: 'Email survey link sending 05.12.2024, 07:30', sentN: 1, sentPct: 100, subN: 0, subPct: 0 },
    ];    function updateFooter(showN, showPct) {
      // Get all tfoot rows except the first one (which is pagination)
      const footerRows = document.querySelectorAll('.table-border-collapse tfoot tr:not(:first-child)');
      
      // Calculate total columns
      const visibleColumns = 1 + (showN ? 2 : 0) + (showPct ? 2 : 0); // 1 for label column
      
      footerRows.forEach(row => {
        // Get all cells in the row
        const cells = row.querySelectorAll('td');
        
        // Skip if no cells (shouldn't happen)
        if (cells.length === 0) return;
        
        // Handle the label cell first
        const labelCell = cells[0];
        
        // Skip first cell (label)
        for (let i = 1; i < cells.length; i++) {
          const isN = i === 1 || i === 3; // First and third data cells are "n" columns
          const isPct = i === 2 || i === 4; // Second and fourth data cells are "%" columns
          
          if ((isN && !showN) || (isPct && !showPct)) {
            cells[i].style.display = 'none';
          } else {
            cells[i].style.display = 'table-cell';
          }
        }
      });
    }

    function renderMainTable() {
      const showN = document.getElementById('toggle-n').checked;
      const showPct = document.getElementById('toggle-pct').checked;
      
      // Get the table element
      const table = document.querySelector('.table-border-collapse');
        // Update table column count and width distribution
      table.classList.remove('single-column', 'n-only', 'pct-only', 'both-visible');
      
      if (!showN && !showPct) {
        // If both are hidden, just show one column
        table.classList.add('single-column');
      } else if (showN && !showPct) {
        // Only N columns visible
        table.classList.add('n-only');
      } else if (!showN && showPct) {
        // Only PCT columns visible
        table.classList.add('pct-only');
      } else {
        // Both visible
        table.classList.add('both-visible');
      }
      
      // Toggle column headers - now with single row header
      document.getElementById('col-n1').style.display = showN ? 'table-cell' : 'none';
      document.getElementById('col-pct1').style.display = showPct ? 'table-cell' : 'none';
      document.getElementById('col-n2').style.display = showN ? 'table-cell' : 'none';
      document.getElementById('col-pct2').style.display = showPct ? 'table-cell' : 'none';
      
      // Update footer rows
      updateFooter(showN, showPct);
      
      // Render rows
      const tbody = document.getElementById('mainTableBody');
      tbody.innerHTML = '';
      
      mainTableData.forEach((row, idx) => {
        const sentStatus = row.sentN > 0 ? 'dot-sent' : 'dot-pending';
        const subStatus = row.subN > 0 ? 'dot-submitted' : 'dot-pending';        tbody.innerHTML += `
          <tr class="border-b border-[#bfc9d1] ${idx % 2 === 0 ? 'bg-white' : 'bg-gray-50'}">
            <td class="py-3 px-4 text-left text-gray-700">${row.label}</td>
            <td class="py-3 px-4 text-center col-n">
              <div class="data-indicator">
                <span class="value">${row.sentN}</span>
              </div>
            </td>
            <td class="py-3 px-4 text-center col-pct">
              <div class="data-indicator">
                <span class="value">${row.sentPct}</span>
              </div>
            </td>
            <td class="py-3 px-4 text-center col-n">
              <div class="data-indicator">
                <span class="value">${row.subN}</span>
              </div>
            </td>
            <td class="py-3 px-4 text-center col-pct">
              <div class="data-indicator">
                <span class="value">${row.subPct}</span>
              </div>
            </td>
          </tr>
        `;
      });
    }
    
    document.getElementById('toggle-n').addEventListener('change', renderMainTable);
    document.getElementById('toggle-pct').addEventListener('change', renderMainTable);
    renderMainTable();
  </script>
</body>
</html>
